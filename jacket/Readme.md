# –°–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π GIT:
```
    https://github.com/nosovdmitry007/jacet.git
```
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–æ–±—Ö–æ–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
```
    pip install --upgrade pip
    cd jacket
    pip install -r requirements.txt
```
3. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å [–≤–µ—Å–∞](https://disk.yandex.ru/d/Ch_yYr4kvGhgEg) –º–æ–¥–µ–ª–µ–π –≤ –ø–∞–ø–∫—É `yolo5`
```
‚îú‚îÄ‚îÄ yolo5 
‚îÇ   ‚îú‚îÄ‚îÄ about.txt
‚îÇ   ‚îú‚îÄ‚îÄ chasha.pt
‚îÇ   ‚îú‚îÄ‚îÄ jalet.pt
‚îÇ   ‚îú‚îÄ‚îÄ yolov5m6.pt
```
## –ü—Ä–∏–º–µ—Ä:
1. –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞:
```
    from person import People, Kadr, Jalet, Chasha
    
    people = People()
    jalet = Jalet()
    chasha = Chasha()
    kad = Kadr()
```
### –î–µ—Ç–µ–∫—Ü–∏—è —á–µ–ª–æ–≤–µ–∫–∞
2. –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è 1-–≥–æ —Ñ–∞–π–ª–∞:
```
    test = people.person_filter('path_to_image.jpg')
    print(test)
```
path_to_image.jpg - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É

–ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ pandas DF.

```
         xmin        ymin        xmax        ymax  confidence  class    name
0  705.028381   49.296021  735.822937  132.415070    0.494404      0  person
1  490.659943  163.209686  532.081177  254.662140    0.342938      0  person
3  663.615906  195.277115  698.396179  283.872375    0.259081      0  person
```

3. –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∏–¥–µ–æ: 
```
    def person_filter_video(put):
        z = kad.cadre(put)
        df = pd.DataFrame()
        for i in tqdm(z, ncols=100):
            str = people.person_filter(i[0],i[1],'person',1)
            df = pd.concat([df, str])
        return df
```
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã people.person_filter:

```
i[0] - –∫–∞–¥—Ä 
i[1] - –º–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
filter - —Ñ–∏–ª—Ç—Ä –∫–∞–ª–∞—Å—Å–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏
1 - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤–∏–¥–µ–æ
```
–ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ pandas DF.

```
           xmin         ymin         xmax         ymax  confidence class  \
0   1131.225098  1118.168457  1234.933105  1225.512573    0.737279     0   
0   1131.433105  1118.231323  1234.431519  1224.986450    0.727406     0   
0   1130.979248  1118.059326  1234.557129  1225.303589    0.731094     0   
0   1130.672974  1118.441040  1234.416260  1225.629272    0.728179     0   
0   1131.116333  1118.653931  1234.319214  1225.085693    0.717301     0   
..          ...          ...          ...          ...         ...   ...   
0   1124.108521  1125.171021  1233.567139  1228.800293    0.571940     0   
0   1123.753784  1125.221558  1233.893311  1228.533569    0.557397     0   
0   1123.530640  1124.986084  1233.745605  1228.137329    0.561760     0   
0   1123.635010  1124.851074  1234.006836  1228.033325    0.543853     0   
0   1123.701050  1125.873413  1234.172485  1227.449341    0.496264     0   

    name   time_cadr  
0   person  0:00:00.00  
0   person  0-00-00.13  
0   person  0-00-00.20  
0   person  0-00-00.33  
0   person  0-00-00.40  
..   ...         ...  
0   person  0-00-29.73  
0   person  0-00-29.80  
0   person  0-00-29.93  
0   person  0:00:30.00  
0   person  0-00-30.13 
```
### –î–µ—Ç–µ–∫—Ü–∏—è –∂–∏–ª–µ—Ç–∞


4. –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è 1-–≥–æ —Ñ–∞–π–ª–∞:
```
    test = jalet.jalet_filter('path_to_image.jpg')
    print(test)
```
path_to_image.jpg - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É

–ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ pandas DF.

```
         xmin        ymin        xmax        ymax  confidence  class    name
0  705.028381   49.296021  735.822937  132.415070    0.494404      0  person
1  490.659943  163.209686  532.081177  254.662140    0.342938      0  person
3  663.615906  195.277115  698.396179  283.872375    0.259081      0  person
```

5. –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∏–¥–µ–æ:
```
    def jalet_filter_video(put):
        z = kad.cadre(put)
        df = pd.DataFrame()
        for i in tqdm(z, ncols=100):
            str = jalet.jalet_filter(i[0],i[1],1)
            df = pd.concat([df, str])
        return df
```
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã people.person_filter:

```
i[0] - –∫–∞–¥—Ä 
i[1] - –º–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
1 - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤–∏–¥–µ–æ
```
–ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ pandas DF.

```
           xmin         ymin         xmax         ymax  confidence class  \
0   1131.225098  1118.168457  1234.933105  1225.512573    0.737279     0   
0   1131.433105  1118.231323  1234.431519  1224.986450    0.727406     0   
0   1130.979248  1118.059326  1234.557129  1225.303589    0.731094     0   
0   1130.672974  1118.441040  1234.416260  1225.629272    0.728179     0   
0   1131.116333  1118.653931  1234.319214  1225.085693    0.717301     0   
..          ...          ...          ...          ...         ...   ...   
0   1124.108521  1125.171021  1233.567139  1228.800293    0.571940     0   
0   1123.753784  1125.221558  1233.893311  1228.533569    0.557397     0   
0   1123.530640  1124.986084  1233.745605  1228.137329    0.561760     0   
0   1123.635010  1124.851074  1234.006836  1228.033325    0.543853     0   
0   1123.701050  1125.873413  1234.172485  1227.449341    0.496264     0   

    name   time_cadr  
0   jalet  0:00:00.00  
0   jalet  0-00-00.13  
0   jalet  0-00-00.20  
0   no_jalet  0-00-00.33  
0   jalet  0-00-00.40  
..   ...         ...  
0   jalet  0-00-29.73  
0   jalet  0-00-29.80  
0   jalet  0-00-29.93  
0   jalet  0:00:30.00  
0   jalet  0-00-30.13 
```
### –î–µ—Ç–µ–∫—Ü–∏—è —á–∞—à–∏


4. –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è 1-–≥–æ —Ñ–∞–π–ª–∞:
```
    test = chasha.chasha_filter('path_to_image.jpg')
    print(test)
```
path_to_image.jpg - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É

–ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ pandas DF.

```
         xmin        ymin        xmax        ymax  confidence  class    name
0  705.028381   49.296021  735.822937  132.415070    0.494404      0  person
1  490.659943  163.209686  532.081177  254.662140    0.342938      0  person
3  663.615906  195.277115  698.396179  283.872375    0.259081      0  person
```

5. –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∏–¥–µ–æ:
```
    def chasha_filter_video(put):
        z = kad.cadre(put)
        df = pd.DataFrame()
        for i in tqdm(z, ncols=100):
            str = chasha.chasha_filter(i[0],i[1],1)
            df = pd.concat([df, str])
        return df
```
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã people.person_filter:

```
i[0] - –∫–∞–¥—Ä 
i[1] - –º–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
1 - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤–∏–¥–µ–æ
```
–ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ pandas DF.

```
           xmin         ymin         xmax         ymax  confidence class  \
0   1131.225098  1118.168457  1234.933105  1225.512573    0.737279     0   
0   1131.433105  1118.231323  1234.431519  1224.986450    0.727406     0   
0   1130.979248  1118.059326  1234.557129  1225.303589    0.731094     0   
0   1130.672974  1118.441040  1234.416260  1225.629272    0.728179     0   
0   1131.116333  1118.653931  1234.319214  1225.085693    0.717301     0   
..          ...          ...          ...          ...         ...   ...   
0   1124.108521  1125.171021  1233.567139  1228.800293    0.571940     0   
0   1123.753784  1125.221558  1233.893311  1228.533569    0.557397     0   
0   1123.530640  1124.986084  1233.745605  1228.137329    0.561760     0   
0   1123.635010  1124.851074  1234.006836  1228.033325    0.543853     0   
0   1123.701050  1125.873413  1234.172485  1227.449341    0.496264     0   

    name   time_cadr  
0   bowl  0:00:00.00  
0   bowl  0-00-00.13  
0   bowl  0-00-00.20  
0   bowl  0-00-00.33  
0   bowl  0-00-00.40  
..   ...         ...  
0   bowl  0-00-29.73  
0   bowl  0-00-29.80  
0   bowl  0-00-29.93  
0   bowl  0:00:30.00  
0   bowl  0-00-30.13 
```

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –∏ –±–æ–∫—Å–æ–≤

–î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –±–æ–∫—Å–æ–≤ –≤ —Ü–∏–∫–ª –≤—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–¥

```
        if len(str.name.unique()) != 0:
            sav(i[0], i[1], str,'test')
```
–ü—Ä–∏–º–µ—Ä:
```
def person_filter_video(put):
    z = kad.cadre(put)
    df = pd.DataFrame()
    for i in tqdm(z, ncols=100):
        str = people.person_filter(i[0],i[1],'person',1)
        df = pd.concat([df, str])
        if len(str.name.unique()) != 0:
            sav(i[0], i[1], str,'test')
    return df
```
i[0] - –∫–∞–¥—Ä 

i[1] - –º–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

str - –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤

'test' - –ø–∞–ø–∫–∞ –∫—É–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–¥—Ä–≤ –∏ *.txt —Ñ–∞–π–ª—ã —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–∞:

![img.png](img.png)

images - –∫–∞—Ç–∞–ª–æ–≥ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
txt - –∫–∞—Ç–∞–ª–æ–≥ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –≤ –ø–∏–∫—Å–µ–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
txt_yolo - –∞—Ç–∞–ª–æ–≥ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YOLO


# –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
1. –í—ã–≥—Ä—É–∑–∏—Ç—å —Ä–∞–∑–º–µ—á–∞–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –≤ –∞–Ω–æ—Ç–∞—Ü–∏–∏ Yolo –∏–∑ Label Studio
2. –†–∞–∑–±–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ (config_dataset)
–∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–∞–ø–∫—É dataset
3. –ï—Å–ª–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏–ª–∏ –∫–ª–∞—Å—Å—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–º–µ–Ω—è—Ç—å YAML —Ñ–∞–π–ª
```
# YOLOv5 üöÄ by Ultralytics, GPL-3.0 license
# COCO128 dataset https://www.kaggle.com/ultralytics/coco128 (first 128 images from COCO train2017) by Ultralytics
# Example usage: python train.py --data coco128.yaml
# parent
# ‚îú‚îÄ‚îÄ yolov5
# ‚îî‚îÄ‚îÄ datasets
#     ‚îî‚îÄ‚îÄ coco128  ‚Üê downloads here (7 MB)


# Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..]
path: ../dataset  # dataset root dir
train: images/train  # train images (relative to 'path') 128 images
val: images/valid  # val images (relative to 'path') 128 images
test:  # test images (optional)

# Classes
names:
  0: bowl


# Download script/URL (optional)
#download: https://ultralytics.com/assets/coco128.zip

```
4. –ü–æ–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ Google Disk
5. –æ—Ç–∫—Ä—ã—Ç—å Google Colab
6. –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–¥:
```
#–£—Å—Ç–∞–Ω–æ–≤–∫–∞ yolo –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
!git clone https://github.com/ultralytics/yolov5.git
%cd yolov5/
!pip install --upgrade pip
!pip install -r requirements.txt
```
```
from google.colab import drive
drive.mount('/content/drive')
```
```
#–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
!cp /content/drive/MyDrive/Stroi/chasha.yaml /content/yolov5/data/chasha.yaml
!unzip /content/drive/MyDrive/Stroi/dataset_chasha.zip -d /content #—Ä–∞–∑–∞—Ä—Ö–∏–≤–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞, –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—Å—è –ø–∞–ø–∫–∞ dataset
```
```
#–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
!python train.py --batch -1 --imgsz 1280 --epochs 500 --data chasha.yaml --weights yolov5m6.pt --project /content/drive/MyDrive/Stroi/yolov5_chasha_best --hyp hyp.Objects365.yaml --cache 'ram'
```

# –ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞:
```
detection_on_cadr(video_file, cat, save_catalog, kad, ramka, probability, save_frame, clas, clas_box, prev_video):

video_file - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
cat - –∫–∞–∫–æ–π –∫–ª–∞—Å—Å –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ('person','chasha','truck')
save_catalog - –ø—É—Ç—å –∫ –∫–∞—Ç–∞–ª–æ–≥—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤
kad = —Å—á–∏—Ç—ã–≤–∞–Ω–∏–µ –∫–∞–¥—Ä–∞ (1 —Ä–∞–∑ –≤ kad —Å–µ–∫—É–Ω–¥ (–¥–ª—è –ø–æ–∫–∞–¥—Ä–æ–≤–æ–≥–æ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è 1/fps))
ramka - —Ä–∏—Å–æ–≤–∞—Ç—å —Ä–∞–º–∫—É –∏–ª–∏ –Ω–µ—Ç (1,0)
probability - –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ä–∞–º–∫—É –∏–ª–∏ –Ω–µ—Ç (1,0)
save_frame - —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –≤ —Ä–∞–º–∫–µ –∏–ª–∏ –Ω–µ—Ç (1,0)
clas - –∫–ª–∞—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –Ω–µ—Ç —á–µ–ª–æ–≤–µ–∫–∞ (1,0)
clas_box - –≤—ã–¥–µ–ª—è—Ç—å —Ä–∞–º–∞–º–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º —á–µ–ª–æ–≤–µ–∫–∞ (1,0)
prev_video - —Å–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
```